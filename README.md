# ZiraatBankQA System

## Overview

The ZiraatBankQA System is a Flask-based web application designed for question answering using IBM Watsonx.ai's Large Language Model (LLM). This application processes and analyzes PDF documents, manages queries from Excel files, and provides contextually relevant responses based on the content of these documents.

## Features

- **PDF Document Upload**: Upload and process PDF files to build a searchable vector store.
- **Excel File Processing**: Upload Excel files containing questions and get answers based on the processed documents.
- **Question Answering**: Query the vector store for relevant information and receive answers generated by IBM Watsonx.ai's LLM.
- **File Management**: Download the processed Excel file with the answers.

## Requirements

- Python 3.8+
- Refer to `requirements.txt` for a complete list of necessary Python packages.

## Setup

### 1. Clone the Repository

Start by cloning the repository to your local machine:

```bash
git clone https://github.ibm.com/Client-Eng-EMEA-IN/Ziraat_FlaskAPI.git
cd Ziraat_FlaskAPI
```

### 2. Install Dependencies

Create and activate a virtual environment, then install the required packages using `requirements.txt`:

```bash
python -m venv venv
source venv/bin/activate  # On Windows use `venv\Scripts\activate`
pip install -r requirements.txt
```

### 3. Configuration

#### Create `.env` File

Create a `.env` file in the root directory of the project with the following content. This file is used for environment variables:

```env
API_KEY=<your-api-key>
IBM_CLOUD_URL=<your-ibm-cloud-url>
PROJECT_ID=<your-project-id>
milvus_password=<your-milvus-password>
```

Replace the placeholders with your actual IBM Cloud credentials and Milvus password.

#### Create `config.ini` File

Create a `config.ini` file in the root directory with Milvus and model configuration details:

```ini
[DEFAULT]
ModelID = <your-model-id>
EmbeddingsModel = <your-embeddings-model>

[Milvus]
CollectionName = <your-collection-name>
Host = <milvus-host>
Port = <milvus-port>
User = <milvus-user>
ServerPemPath = <path-to-server-pem>
ServerName = <server-name>
```

Replace the placeholders with your actual configuration values for Milvus and the model.

## Running the Application

### Start the Flask Server

To start the Flask server, run the following command:

```bash
python app.py
```

The server will start and be accessible at `http://127.0.0.1:8510` by default.

### Web Interface

Access the web interface through your browser at `http://127.0.0.1:8510`. You can use this interface to:

- **Upload PDFs**: Add PDF files to build or update the document vector store.
- **Upload Excel**: Submit an Excel file with questions to process and receive answers.
- **Ask Questions**: Directly ask questions and get responses based on the document content.

## Endpoints

### `GET /`

Displays the main index page of the application.

### `POST /upload_pdfs`

Uploads PDF files for processing.

- **Form-data field**: `pdf_files` (Multiple files allowed)

### `POST /upload_excel`

Uploads an Excel file containing questions.

- **Form-data field**: `excel_file`

### `GET /download_processed_excel`

Downloads the processed Excel file containing the answers.

### `POST /ask_question`

Submits a question to the system and retrieves a response.

- **JSON Payload**: 

  ```json
  {
    "query": "Your question here"
  }
  ```

## Example Usage

1. **Upload PDFs**: Use the `/upload_pdfs` endpoint to upload one or more PDF files. The system processes these files to create or update a vector store for document searching.

2. **Upload Excel**: Upload an Excel file with questions using the `/upload_excel` endpoint. The system will use the processed documents to generate responses and provide a link to download the updated Excel file.

3. **Ask a Question**: Use the `/ask_question` endpoint to submit a question. The system will query the vector store and use IBM Watsonx.ai's LLM to generate and return an answer.

## Troubleshooting

- **No `.env` or `config.ini` file**: Ensure these files are created in the root directory with the correct configurations. Missing or incorrect settings can cause the application to fail.
- **Missing Packages**: If you encounter issues with missing packages, verify that all dependencies are listed in `requirements.txt` and installed correctly.
- **Server Issues**: If the Flask server does not start or behaves unexpectedly, check the console output for error messages and ensure all configurations are correct.
